<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arena PLM Ingestion Pipeline ‚Äî Portfolio</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600&family=Fraunces:ital,wght@0,300;0,600;0,700;1,300;1,600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:       #080c14;
    --bg2:      #0d1320;
    --bg3:      #111a2e;
    --border:   #1e2d4a;
    --border2:  #243352;
    --muted:    #4a6080;
    --mid:      #7a95b8;
    --bright:   #c8daf0;
    --white:    #eef4fc;
    --accent:   #3b82f6;
    --accent2:  #22d3ee;
    --green:    #10b981;
    --amber:    #f59e0b;
    --red:      #ef4444;
    --purple:   #8b5cf6;
    --mono:     'IBM Plex Mono', monospace;
    --serif:    'Fraunces', serif;
  }

  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }

  body {
    font-family: var(--mono);
    background: var(--bg);
    color: var(--bright);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    cursor: default;
  }

  /* ‚îÄ‚îÄ SCANLINE EFFECT ‚îÄ‚îÄ */
  body::before {
    content: '';
    position: fixed; inset: 0; z-index: 1000;
    background: repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0,0,0,.03) 2px,
      rgba(0,0,0,.03) 4px
    );
    pointer-events: none;
  }

  /* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
  nav {
    position: fixed; top: 0; left: 0; right: 0; z-index: 100;
    background: rgba(8,12,20,.92);
    backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
    height: 56px;
    display: flex; align-items: center;
    padding: 0 clamp(16px, 4vw, 56px);
    justify-content: space-between;
    font-size: 12px;
  }
  .nav-brand {
    display: flex; align-items: center; gap: 10px;
    text-decoration: none; color: var(--white);
    font-weight: 600; letter-spacing: .04em;
  }
  .nav-brand-icon {
    width: 28px; height: 28px; border-radius: 6px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    display: flex; align-items: center; justify-content: center;
    font-size: 14px;
  }
  .nav-right { display: flex; align-items: center; gap: 24px; }
  .nav-right a {
    color: var(--muted); text-decoration: none;
    font-size: 11px; letter-spacing: .06em; text-transform: uppercase;
    transition: color .2s;
  }
  .nav-right a:hover { color: var(--bright); }
  .nav-back {
    color: var(--accent) !important;
    display: flex; align-items: center; gap: 6px;
  }

  /* ‚îÄ‚îÄ HERO ‚îÄ‚îÄ */
  .hero {
    min-height: 100vh;
    display: flex; flex-direction: column; justify-content: center;
    padding: 80px clamp(16px, 4vw, 56px) 60px;
    position: relative; overflow: hidden;
  }

  /* Animated grid background */
  .hero-grid {
    position: absolute; inset: 0; z-index: 0;
    background-image:
      linear-gradient(var(--border) 1px, transparent 1px),
      linear-gradient(90deg, var(--border) 1px, transparent 1px);
    background-size: 40px 40px;
    opacity: .4;
    mask-image: radial-gradient(ellipse 80% 80% at 50% 50%, black 30%, transparent 100%);
  }

  /* Glow orbs */
  .hero-glow {
    position: absolute; z-index: 0; border-radius: 50%;
    filter: blur(80px); pointer-events: none;
  }
  .hero-glow-1 {
    width: 500px; height: 500px;
    background: radial-gradient(circle, rgba(59,130,246,.12), transparent 70%);
    top: -100px; right: -100px;
  }
  .hero-glow-2 {
    width: 400px; height: 400px;
    background: radial-gradient(circle, rgba(34,211,238,.08), transparent 70%);
    bottom: 0; left: 10%;
  }

  .hero-inner { position: relative; z-index: 1; max-width: 1100px; }

  .hero-eyebrow {
    display: flex; align-items: center; gap: 10px;
    font-size: 11px; letter-spacing: .12em; text-transform: uppercase;
    color: var(--accent2); margin-bottom: 28px;
  }
  .hero-eyebrow::before {
    content: ''; width: 24px; height: 1px; background: var(--accent2);
  }

  h1 {
    font-family: var(--serif);
    font-size: clamp(38px, 5.5vw, 72px);
    font-weight: 600; line-height: 1.08;
    letter-spacing: -.02em;
    color: var(--white);
    margin-bottom: 8px;
  }
  h1 em {
    font-style: italic; font-weight: 300;
    color: var(--accent2);
  }
  .hero-sub-title {
    font-family: var(--serif); font-style: italic; font-weight: 300;
    font-size: clamp(20px, 3vw, 32px);
    color: var(--muted); margin-bottom: 32px;
    letter-spacing: -.01em;
  }

  .hero-desc {
    font-size: 14px; color: var(--mid); line-height: 1.8;
    max-width: 620px; margin-bottom: 40px;
    font-weight: 300;
  }

  .hero-tags {
    display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 40px;
  }
  .tag {
    font-size: 11px; letter-spacing: .06em; text-transform: uppercase;
    padding: 5px 12px; border-radius: 4px; font-weight: 500;
    border: 1px solid;
  }
  .tag-blue   { color: var(--accent);  border-color: rgba(59,130,246,.3);  background: rgba(59,130,246,.06); }
  .tag-cyan   { color: var(--accent2); border-color: rgba(34,211,238,.3);  background: rgba(34,211,238,.06); }
  .tag-green  { color: var(--green);   border-color: rgba(16,185,129,.3);  background: rgba(16,185,129,.06); }
  .tag-purple { color: var(--purple);  border-color: rgba(139,92,246,.3);  background: rgba(139,92,246,.06); }
  .tag-amber  { color: var(--amber);   border-color: rgba(245,158,11,.3);  background: rgba(245,158,11,.06); }

  /* Terminal window */
  .terminal {
    background: var(--bg2);
    border: 1px solid var(--border2);
    border-radius: 10px; overflow: hidden;
    max-width: 680px;
    box-shadow: 0 24px 80px rgba(0,0,0,.5), 0 0 0 1px rgba(255,255,255,.04);
  }
  .terminal-bar {
    background: var(--bg3); border-bottom: 1px solid var(--border);
    padding: 10px 16px;
    display: flex; align-items: center; gap: 8px;
  }
  .tbar-dot { width: 12px; height: 12px; border-radius: 50%; }
  .tbar-title {
    margin-left: 8px; font-size: 11px; color: var(--muted);
    letter-spacing: .04em;
  }
  .terminal-body {
    padding: 20px 24px; font-size: 12px; line-height: 2;
  }
  .t-comment { color: var(--muted); }
  .t-cmd     { color: var(--accent2); }
  .t-ok      { color: var(--green); }
  .t-val     { color: var(--accent); }
  .t-warn    { color: var(--amber); }
  .t-prompt  { color: var(--purple); }
  .t-dim     { color: #2a3a55; }
  .t-white   { color: var(--white); }
  .blink {
    display: inline-block; width: 8px; height: 14px;
    background: var(--accent2); vertical-align: middle;
    animation: blink .9s step-end infinite;
  }
  @keyframes blink { 50% { opacity: 0; } }

  /* ‚îÄ‚îÄ SECTION COMMON ‚îÄ‚îÄ */
  section {
    padding: 80px clamp(16px,4vw,56px);
    border-top: 1px solid var(--border);
  }
  .section-inner { max-width: 1100px; margin: 0 auto; }
  .section-label {
    font-size: 11px; letter-spacing: .12em; text-transform: uppercase;
    color: var(--accent); margin-bottom: 12px;
    display: flex; align-items: center; gap: 10px;
  }
  .section-label::before { content: '//'; color: var(--border2); }
  h2 {
    font-family: var(--serif); font-size: clamp(24px, 3vw, 40px);
    font-weight: 600; color: var(--white); letter-spacing: -.02em;
    line-height: 1.2; margin-bottom: 14px;
  }
  .section-sub {
    font-size: 14px; color: var(--mid); max-width: 560px;
    line-height: 1.8; font-weight: 300;
  }

  /* ‚îÄ‚îÄ PROBLEM ‚îÄ‚îÄ */
  .problem-grid {
    display: grid; grid-template-columns: 1fr 1fr; gap: 20px;
    margin-top: 48px;
  }
  .p-card {
    border: 1px solid var(--border2); border-radius: 8px;
    padding: 28px; position: relative; overflow: hidden;
  }
  .p-card::before {
    content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  }
  .p-card.before::before { background: var(--red); }
  .p-card.after::before  { background: var(--green); }
  .p-card-label {
    font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
    font-weight: 600; margin-bottom: 16px;
    display: flex; align-items: center; gap: 8px;
  }
  .p-card.before .p-card-label { color: var(--red); }
  .p-card.after  .p-card-label { color: var(--green); }
  .p-card h3 {
    font-family: var(--serif); font-size: 20px; font-weight: 600;
    color: var(--white); margin-bottom: 16px;
  }
  .p-list { list-style: none; display: flex; flex-direction: column; gap: 9px; }
  .p-list li {
    font-size: 13px; color: var(--mid); line-height: 1.6;
    display: flex; gap: 10px; align-items: flex-start;
  }
  .p-list li .ico { flex-shrink: 0; margin-top: 2px; }

  /* ‚îÄ‚îÄ ARCHITECTURE ‚îÄ‚îÄ */
  .arch-section { background: var(--bg2); }

  .pipeline-diagram {
    margin-top: 52px;
    display: flex; flex-direction: column; gap: 2px;
  }

  .pipe-layer {
    display: grid; grid-template-columns: 140px 1fr;
    gap: 0; align-items: stretch;
  }
  .pipe-label {
    display: flex; align-items: center; justify-content: flex-end;
    padding-right: 20px;
    font-size: 10px; letter-spacing: .1em; text-transform: uppercase;
    font-weight: 600; color: var(--muted);
    border-right: 1px solid var(--border2);
  }
  .pipe-content {
    display: flex; align-items: center; gap: 0;
    padding: 12px 0 12px 20px;
  }
  .pipe-node {
    display: flex; flex-direction: column;
    border: 1px solid var(--border2); border-radius: 8px;
    padding: 14px 18px; min-width: 140px;
    background: var(--bg3); position: relative;
    transition: border-color .2s, box-shadow .2s;
  }
  .pipe-node:hover {
    border-color: var(--accent);
    box-shadow: 0 0 20px rgba(59,130,246,.1);
  }
  .pipe-node-icon { font-size: 18px; margin-bottom: 6px; }
  .pipe-node-title {
    font-size: 12px; font-weight: 600; color: var(--white);
    margin-bottom: 3px;
  }
  .pipe-node-sub { font-size: 10px; color: var(--muted); line-height: 1.4; }
  .pipe-node.highlight { border-color: var(--accent2); background: rgba(34,211,238,.04); }
  .pipe-node.highlight .pipe-node-title { color: var(--accent2); }

  .pipe-arrow {
    display: flex; align-items: center; padding: 0 12px;
    color: var(--border2); font-size: 16px; flex-shrink: 0;
  }

  .pipe-multi {
    display: flex; gap: 8px; flex-wrap: wrap;
  }

  /* ‚îÄ‚îÄ CODE FEATURES ‚îÄ‚îÄ */
  .features-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;
    margin-top: 48px;
  }
  .feat {
    border: 1px solid var(--border2); border-radius: 8px;
    padding: 24px; transition: all .2s;
    position: relative; overflow: hidden;
  }
  .feat::after {
    content: ''; position: absolute;
    top: 0; left: 0; right: 0; height: 1px;
    background: linear-gradient(90deg, transparent, var(--accent), transparent);
    opacity: 0; transition: opacity .2s;
  }
  .feat:hover { border-color: var(--accent); background: rgba(59,130,246,.03); }
  .feat:hover::after { opacity: 1; }
  .feat-num {
    font-size: 10px; letter-spacing: .1em; color: var(--muted);
    margin-bottom: 12px;
  }
  .feat h4 {
    font-family: var(--serif); font-size: 16px; font-weight: 600;
    color: var(--white); margin-bottom: 8px; line-height: 1.3;
  }
  .feat p { font-size: 12px; color: var(--mid); line-height: 1.7; font-weight: 300; }

  /* ‚îÄ‚îÄ CODE SNIPPETS ‚îÄ‚îÄ */
  .code-section { background: var(--bg2); }
  .code-tabs {
    display: flex; gap: 2px; margin-top: 40px;
    background: var(--bg3); border: 1px solid var(--border);
    border-radius: 8px 8px 0 0; padding: 4px; width: fit-content;
  }
  .code-tab {
    padding: 7px 16px; border-radius: 5px; border: none;
    font-family: var(--mono); font-size: 11px; font-weight: 500;
    letter-spacing: .04em; cursor: pointer; transition: all .18s;
    background: transparent; color: var(--muted);
  }
  .code-tab.active { background: var(--bg); color: var(--accent2); }
  .code-panel { display: none; }
  .code-panel.active { display: block; }
  .code-window {
    background: var(--bg); border: 1px solid var(--border);
    border-radius: 0 8px 8px 8px; overflow: hidden;
    box-shadow: 0 8px 32px rgba(0,0,0,.4);
  }
  .code-window-bar {
    background: var(--bg3); border-bottom: 1px solid var(--border);
    padding: 10px 16px; display: flex; align-items: center; gap: 6px;
    font-size: 11px; color: var(--muted);
  }
  .code-window-bar span { margin-left: 8px; }
  pre {
    padding: 24px; font-size: 12px; line-height: 1.8;
    overflow-x: auto; tab-size: 4;
    font-family: var(--mono);
  }
  .kw  { color: #c084fc; } /* keyword */
  .fn  { color: #60a5fa; } /* function */
  .str { color: #4ade80; } /* string */
  .cm  { color: #374f6e; } /* comment */
  .nb  { color: #fb923c; } /* number/built-in */
  .cl  { color: #f59e0b; } /* class */
  .op  { color: #94a3b8; } /* operator */

  /* ‚îÄ‚îÄ DATA MODEL ‚îÄ‚îÄ */
  .tables-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;
    margin-top: 48px;
  }
  .table-card {
    border: 1px solid var(--border2); border-radius: 8px; overflow: hidden;
  }
  .table-header {
    background: var(--bg3); border-bottom: 1px solid var(--border);
    padding: 12px 16px;
    display: flex; align-items: center; justify-content: space-between;
  }
  .table-name {
    font-size: 12px; font-weight: 600; color: var(--accent2);
    display: flex; align-items: center; gap: 8px;
  }
  .table-badge {
    font-size: 9px; letter-spacing: .08em; text-transform: uppercase;
    padding: 2px 7px; border-radius: 100px; font-weight: 600;
  }
  .tb-bronze { background: rgba(245,158,11,.15); color: var(--amber); }
  .tb-silver { background: rgba(148,163,184,.15); color: #94a3b8; }
  .table-body { padding: 12px; }
  .col-row {
    display: flex; align-items: center; justify-content: space-between;
    padding: 5px 6px; border-radius: 4px; font-size: 11px;
    transition: background .15s;
  }
  .col-row:hover { background: rgba(255,255,255,.03); }
  .col-name { color: var(--bright); font-weight: 500; }
  .col-type { color: var(--muted); font-size: 10px; }
  .col-pk { color: var(--accent); font-size: 9px; font-weight: 700; }
  .col-meta { color: var(--border2); font-size: 10px; font-style: italic; }

  /* ‚îÄ‚îÄ METRICS ‚îÄ‚îÄ */
  .metrics-row {
    display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;
    margin-top: 48px;
  }
  .metric-card {
    border: 1px solid var(--border2); border-radius: 8px;
    padding: 28px 24px; text-align: center;
    position: relative; overflow: hidden;
    transition: border-color .2s;
  }
  .metric-card:hover { border-color: var(--accent); }
  .metric-card::before {
    content: ''; position: absolute;
    inset: 0; opacity: .03;
    background: linear-gradient(135deg, var(--accent), transparent);
  }
  .metric-val {
    font-family: var(--serif); font-size: 44px; font-weight: 600;
    color: var(--white); line-height: 1; margin-bottom: 8px;
    position: relative;
  }
  .metric-val sup { font-size: 20px; vertical-align: super; }
  .metric-val .unit { font-family: var(--mono); font-size: 18px; color: var(--accent2); }
  .metric-desc { font-size: 11px; color: var(--muted); line-height: 1.5; }

  /* ‚îÄ‚îÄ SKILLS ‚îÄ‚îÄ */
  .skills-section { background: var(--bg2); }
  .skills-grid {
    display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;
    margin-top: 48px;
  }
  .skill-item {
    border: 1px solid var(--border2); border-radius: 6px;
    padding: 16px 18px;
    display: flex; align-items: flex-start; gap: 14px;
    transition: all .2s;
  }
  .skill-item:hover { border-color: var(--accent); background: rgba(59,130,246,.03); }
  .skill-cat {
    font-size: 10px; letter-spacing: .08em; text-transform: uppercase;
    font-weight: 600; padding: 3px 8px; border-radius: 4px;
    flex-shrink: 0; min-width: 88px; text-align: center; margin-top: 1px;
  }
  .sc-python { background: rgba(59,130,246,.15); color: var(--accent); }
  .sc-spark  { background: rgba(245,158,11,.15); color: var(--amber); }
  .sc-delta  { background: rgba(16,185,129,.15); color: var(--green); }
  .sc-api    { background: rgba(34,211,238,.15); color: var(--accent2); }
  .sc-de     { background: rgba(139,92,246,.15); color: var(--purple); }
  .skill-text { font-size: 12px; color: var(--mid); line-height: 1.6; font-weight: 300; }
  .skill-text strong { color: var(--bright); font-weight: 500; }

  /* ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ */
  footer {
    border-top: 1px solid var(--border);
    padding: 36px clamp(16px,4vw,56px);
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 16px; font-size: 12px;
  }
  .footer-left { color: var(--muted); }
  .footer-left strong { color: var(--mid); }
  .footer-links { display: flex; gap: 20px; }
  .footer-links a { color: var(--muted); text-decoration: none; transition: color .2s; }
  .footer-links a:hover { color: var(--accent2); }

  /* ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ */
  .reveal {
    opacity: 0; transform: translateY(16px);
    transition: opacity .7s ease, transform .7s ease;
  }
  .reveal.in { opacity: 1; transform: translateY(0); }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media (max-width: 900px) {
    .problem-grid  { grid-template-columns: 1fr; }
    .features-grid { grid-template-columns: repeat(2, 1fr); }
    .tables-grid   { grid-template-columns: repeat(2, 1fr); }
    .metrics-row   { grid-template-columns: repeat(2, 1fr); }
    .skills-grid   { grid-template-columns: 1fr; }
    .pipe-layer    { grid-template-columns: 80px 1fr; }
  }
  @media (max-width: 640px) {
    .features-grid { grid-template-columns: 1fr; }
    .tables-grid   { grid-template-columns: 1fr; }
    .pipe-multi    { flex-direction: column; }
    nav .nav-right .nav-back { display: flex; }
    nav .nav-right a:not(.nav-back) { display: none; }
  }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <a class="nav-brand" href="index.html">
    <div class="nav-brand-icon">‚óà</div>
    YourName
  </a>
  <div class="nav-right">
    <a href="#problem">Problem</a>
    <a href="#architecture">Architecture</a>
    <a href="#code">Code</a>
    <a href="#skills">Skills</a>
    <a href="index.html" class="nav-back">‚Üê Portfolio</a>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-grid"></div>
  <div class="hero-glow hero-glow-1"></div>
  <div class="hero-glow hero-glow-2"></div>

  <div class="hero-inner">
    <div class="hero-eyebrow">Data Engineering ¬∑ Databricks ¬∑ Python</div>

    <h1>Arena PLM <em>Ingestion</em></h1>
    <div class="hero-sub-title">Production pipeline on Databricks Unity Catalog</div>

    <p class="hero-desc">
      A config-driven, fault-tolerant data ingestion pipeline that extracts multi-level
      hierarchical data from the Arena PLM REST API ‚Äî Items, BOMs, Revisions, Procurement,
      and BOM Substitutes ‚Äî and lands it into Delta Lake bronze tables with full
      checkpointing, parallelism, and crash recovery.
    </p>

    <div class="hero-tags">
      <span class="tag tag-blue">Python</span>
      <span class="tag tag-amber">Apache Spark</span>
      <span class="tag tag-cyan">Databricks</span>
      <span class="tag tag-green">Delta Lake</span>
      <span class="tag tag-purple">REST API</span>
      <span class="tag tag-blue">Unity Catalog</span>
      <span class="tag tag-cyan">ThreadPoolExecutor</span>
      <span class="tag tag-amber">Arena PLM</span>
    </div>

    <div class="terminal">
      <div class="terminal-bar">
        <div class="tbar-dot" style="background:#ef4444"></div>
        <div class="tbar-dot" style="background:#f59e0b"></div>
        <div class="tbar-dot" style="background:#10b981"></div>
        <div class="tbar-title">arena_pipeline.log</div>
      </div>
      <div class="terminal-body">
        <div><span class="t-comment">============================================================</span></div>
        <div><span class="t-white">ARENA PIPELINE: ITEMS</span></div>
        <div><span class="t-comment">============================================================</span></div>
        <div><span class="t-dim">  Endpoint:      https://api.arenasolutions.com/v1/items</span></div>
        <div><span class="t-dim">  Target Table:  kymeta_dbx.arena_bronze.items</span></div>
        <div>&nbsp;</div>
        <div><span class="t-ok">‚úî Arena session established</span></div>
        <div><span class="t-ok">‚úî LOAD TYPE: INCREMENTAL</span></div>
        <div>&nbsp;</div>
        <div><span class="t-cmd">üì° Page 1: Fetching offset=4200...</span></div>
        <div><span class="t-dim">  ‚ûú Fetched 400 records (total: 400)</span></div>
        <div><span class="t-cmd">üíæ MERGING BATCH: 400 records</span></div>
        <div><span class="t-ok">  ‚úî Batch merged successfully</span></div>
        <div><span class="t-ok">  ‚úî Checkpoint saved: offset=4600</span></div>
        <div>&nbsp;</div>
        <div><span class="t-ok">‚úÖ PIPELINE COMPLETED SUCCESSFULLY</span></div>
        <div><span class="t-dim">  Records Fetched:    400</span></div>
        <div><span class="t-dim">  Total in Table:     4,600</span></div>
        <div><span class="t-val">  Duration:           12.4 seconds</span></div>
        <div>&nbsp;</div>
        <div><span class="t-prompt">$</span> <span class="blink"></span></div>
      </div>
    </div>
  </div>
</section>

<!-- PROBLEM -->
<section id="problem">
  <div class="section-inner">
    <div class="section-label reveal">The Problem</div>
    <h2 class="reveal">Arena PLM data was<br>trapped in a silo</h2>
    <p class="section-sub reveal">
      The business needed Arena's product data ‚Äî BOMs, revisions, procurement details ‚Äî
      available in Databricks for downstream analytics. Nothing existed. It had to be built from scratch.
    </p>

    <div class="problem-grid">
      <div class="p-card before reveal">
        <div class="p-card-label">‚úï Before</div>
        <h3>No data pipeline existed</h3>
        <ul class="p-list">
          <li><span class="ico" style="color:var(--red)">‚úï</span> Arena PLM data only accessible through Arena's own UI ‚Äî not queryable</li>
          <li><span class="ico" style="color:var(--red)">‚úï</span> Multi-level hierarchy (Items ‚Üí BOM ‚Üí Substitutes) required 3 separate API calls per item</li>
          <li><span class="ico" style="color:var(--red)">‚úï</span> No historical load capability ‚Äî full refresh would miss incremental changes</li>
          <li><span class="ico" style="color:var(--red)">‚úï</span> No fault tolerance ‚Äî any API failure meant restarting the entire extract from scratch</li>
          <li><span class="ico" style="color:var(--red)">‚úï</span> Thousands of items √ó multiple child endpoints = hours of sequential API calls</li>
          <li><span class="ico" style="color:var(--red)">‚úï</span> No audit trail ‚Äî no way to know what ran, when, or whether it succeeded</li>
        </ul>
      </div>
      <div class="p-card after reveal">
        <div class="p-card-label">‚úì After</div>
        <h3>Production pipeline on Databricks</h3>
        <ul class="p-list">
          <li><span class="ico" style="color:var(--green)">‚úì</span> Config-driven design ‚Äî add any new Arena endpoint with zero code changes</li>
          <li><span class="ico" style="color:var(--green)">‚úì</span> Full 3-level hierarchy: Items ‚Üí Child endpoints ‚Üí Grandchild (BOM Substitutes)</li>
          <li><span class="ico" style="color:var(--green)">‚úì</span> Auto-detects HISTORICAL vs INCREMENTAL ‚Äî first run loads all, subsequent runs pick up changes</li>
          <li><span class="ico" style="color:var(--green)">‚úì</span> Crash recovery via control table checkpointing ‚Äî resumes from last saved offset</li>
          <li><span class="ico" style="color:var(--green)">‚úì</span> ThreadPoolExecutor with 10 parallel workers ‚Äî child endpoint fetches run concurrently</li>
          <li><span class="ico" style="color:var(--green)">‚úì</span> Full audit trail in Delta control table ‚Äî every run logged with status, duration, record counts</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- ARCHITECTURE -->
<section class="arch-section" id="architecture">
  <div class="section-inner">
    <div class="section-label reveal">Architecture</div>
    <h2 class="reveal">Four-notebook pipeline</h2>
    <p class="section-sub reveal">
      Each notebook has a single responsibility. Utility initialises shared state.
      Parent, child, and grandchild pipelines run in sequence, each feeding the next.
    </p>

    <div class="pipeline-diagram reveal">

      <div class="pipe-layer" style="padding-bottom:8px">
        <div class="pipe-label">Source</div>
        <div class="pipe-content">
          <div class="pipe-node">
            <div class="pipe-node-icon">üè≠</div>
            <div class="pipe-node-title">Arena PLM API</div>
            <div class="pipe-node-sub">api.arenasolutions.com/v1<br>REST ¬∑ JSON ¬∑ Paginated</div>
          </div>
          <div class="pipe-arrow">‚Üí</div>
          <div class="pipe-node">
            <div class="pipe-node-icon">üîê</div>
            <div class="pipe-node-title">Auth + Session</div>
            <div class="pipe-node-sub">Databricks Secret Scope<br>ArenaSession class ¬∑ Auto-refresh</div>
          </div>
        </div>
      </div>

      <div class="pipe-layer" style="padding-bottom:8px">
        <div class="pipe-label">Config</div>
        <div class="pipe-content">
          <div class="pipe-node highlight">
            <div class="pipe-node-icon">‚öôÔ∏è</div>
            <div class="pipe-node-title">config.json</div>
            <div class="pipe-node-sub">Endpoints ¬∑ Pagination<br>Batch sizes ¬∑ Retries ¬∑ Secrets</div>
          </div>
          <div class="pipe-arrow">‚Üí</div>
          <div class="pipe-node highlight">
            <div class="pipe-node-icon">üõ†Ô∏è</div>
            <div class="pipe-node-title">utility.py</div>
            <div class="pipe-node-sub">Config loader ¬∑ Session mgr<br>robust_get ¬∑ Control table</div>
          </div>
        </div>
      </div>

      <div class="pipe-layer" style="padding-bottom:8px">
        <div class="pipe-label">Ingest</div>
        <div class="pipe-content">
          <div class="pipe-multi">
            <div class="pipe-node">
              <div class="pipe-node-icon">üì¶</div>
              <div class="pipe-node-title">bronze_parent.py</div>
              <div class="pipe-node-sub">Items endpoint<br>Offset pagination ¬∑ MERGE</div>
            </div>
            <div class="pipe-arrow">‚Üí</div>
            <div class="pipe-node">
              <div class="pipe-node-icon">üîó</div>
              <div class="pipe-node-title">bronze_child.py</div>
              <div class="pipe-node-sub">BOM ¬∑ Revisions ¬∑ Procurement<br>Parallel fetch ¬∑ ThreadPoolExecutor</div>
            </div>
            <div class="pipe-arrow">‚Üí</div>
            <div class="pipe-node">
              <div class="pipe-node-icon">üß©</div>
              <div class="pipe-node-title">bronze_grandchild.py</div>
              <div class="pipe-node-sub">BOM Substitutes<br>Spark anti-join dedup ¬∑ Chunked</div>
            </div>
          </div>
        </div>
      </div>

      <div class="pipe-layer">
        <div class="pipe-label">Storage</div>
        <div class="pipe-content">
          <div class="pipe-multi">
            <div class="pipe-node highlight">
              <div class="pipe-node-icon">üóÑÔ∏è</div>
              <div class="pipe-node-title">Delta Lake Bronze</div>
              <div class="pipe-node-sub">Unity Catalog ¬∑ arena_bronze<br>items ¬∑ item_bom ¬∑ item_revisions<br>item_procurement ¬∑ item_bom_substitutes</div>
            </div>
            <div class="pipe-arrow">‚Üí</div>
            <div class="pipe-node">
              <div class="pipe-node-icon">üìã</div>
              <div class="pipe-node-title">arena_control</div>
              <div class="pipe-node-sub">Run log ¬∑ Checkpoints<br>Status ¬∑ Duration ¬∑ Counts</div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- CODE FEATURES -->
<section id="features">
  <div class="section-inner">
    <div class="section-label reveal">Engineering Decisions</div>
    <h2 class="reveal">Built for production,<br>not just a demo</h2>
    <p class="section-sub reveal">
      Every design choice exists to handle a real failure mode ‚Äî not to look impressive.
    </p>

    <div class="features-grid">
      <div class="feat reveal">
        <div class="feat-num">01</div>
        <h4>Config-driven endpoints</h4>
        <p>Parent, child, and grandchild endpoints are fully defined in config.json. Adding a new Arena endpoint requires zero code changes ‚Äî just a config entry with path, table name, and enabled flag.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">02</div>
        <h4>Auto HISTORICAL / INCREMENTAL</h4>
        <p>Pipeline checks the control table on startup. No previous SUCCESS record ‚Üí full historical load. SUCCESS found ‚Üí incremental from last saved offset. No manual flag needed.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">03</div>
        <h4>Exponential backoff retries</h4>
        <p>robust_get() retries up to 6 times with doubling backoff. Handles 401 (session refresh), 429 (rate limit with Retry-After header), 5xx server errors, and network timeouts independently.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">04</div>
        <h4>Delta MERGE upserts</h4>
        <p>Every batch write uses MERGE INTO ‚Äî matched rows update all fields except _ingested_at (audit trail preserved). First batch creates the table with schema inference. Fully idempotent.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">05</div>
        <h4>ThreadPoolExecutor parallelism</h4>
        <p>Child and grandchild pipelines fetch up to 10 items simultaneously using concurrent.futures. Sequential fetching of thousands of items would take hours ‚Äî parallel reduces it to minutes.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">06</div>
        <h4>Spark anti-join deduplication</h4>
        <p>Grandchild pipeline uses a distributed LEFT ANTI JOIN to filter already-processed BOM lines ‚Äî not a Python set comparison. Scales to millions of records without driver memory pressure.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">07</div>
        <h4>Control table checkpointing</h4>
        <p>Offset and record count saved to arena_control after every batch write. Pipeline crash on page 47? Next run resumes from page 47. The control table also doubles as a full audit log.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">08</div>
        <h4>Graceful error classification</h4>
        <p>Errors split into SKIP (403/404 ‚Äî access restricted, don't retry), FAIL (server errors ‚Äî retry with backoff), and PARTIAL_SUCCESS (some items failed ‚Äî pipeline still completes). No binary pass/fail.</p>
      </div>
      <div class="feat reveal">
        <div class="feat-num">09</div>
        <h4>Chunked memory management</h4>
        <p>Grandchild pipeline processes BOM lines in chunks of 5,000 before submitting to ThreadPoolExecutor. Prevents driver OOM errors when handling hundreds of thousands of BOM lines.</p>
      </div>
    </div>
  </div>
</section>

<!-- CODE SNIPPETS -->
<section class="code-section" id="code">
  <div class="section-inner">
    <div class="section-label reveal">Code Deep-Dive</div>
    <h2 class="reveal">Key implementation patterns</h2>
    <p class="section-sub reveal">The engineering patterns that make this production-ready.</p>

    <div class="code-tabs reveal">
      <button class="code-tab active" onclick="showCode('retry')">Retry Logic</button>
      <button class="code-tab" onclick="showCode('merge')">Delta MERGE</button>
      <button class="code-tab" onclick="showCode('parallel')">Parallelism</button>
      <button class="code-tab" onclick="showCode('antijoin')">Anti-Join Dedup</button>
      <button class="code-tab" onclick="showCode('control')">Control Table</button>
    </div>

    <div class="code-panel active" id="code-retry">
      <div class="code-window reveal">
        <div class="code-window-bar">
          <div class="tbar-dot" style="background:#ef4444;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#f59e0b;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#10b981;width:10px;height:10px;border-radius:50%"></div>
          <span>utility.py ‚Äî robust_get()</span>
        </div>
        <pre><span class="kw">def</span> <span class="fn">robust_get</span>(url, params=<span class="kw">None</span>):
    <span class="cm">"""GET with retry, rate limiting, and session refresh."""</span>
    max_retries = RETRY_CONFIG[<span class="str">"max_retries"</span>]   <span class="cm"># 6 attempts</span>
    backoff     = RETRY_CONFIG[<span class="str">"initial_backoff_seconds"</span>]  <span class="cm"># 2s ‚Üí 4 ‚Üí 8 ‚Üí 16 ‚Üí 32 ‚Üí 64</span>
    refreshed   = <span class="kw">False</span>

    <span class="kw">for</span> attempt <span class="kw">in</span> <span class="fn">range</span>(<span class="nb">1</span>, max_retries + <span class="nb">1</span>):
        <span class="kw">try</span>:
            resp = requests.<span class="fn">get</span>(url, params=params,
                               headers=ARENA_SESSION.<span class="fn">headers</span>(),
                               timeout=<span class="nb">60</span>)
        <span class="kw">except</span> (Timeout, ConnectionError):
            time.<span class="fn">sleep</span>(backoff); backoff *= <span class="nb">2</span>; <span class="kw">continue</span>

        <span class="kw">if</span> resp.status_code == <span class="nb">200</span>: <span class="kw">return</span> resp          <span class="cm"># ‚úì success</span>

        <span class="kw">if</span> resp.status_code == <span class="nb">401</span> <span class="kw">and not</span> refreshed:      <span class="cm"># session expired</span>
            ARENA_SESSION.<span class="fn">refresh</span>(); refreshed = <span class="kw">True</span>; <span class="kw">continue</span>

        <span class="kw">if</span> resp.status_code == <span class="nb">429</span>:                          <span class="cm"># rate limited</span>
            wait = <span class="fn">float</span>(resp.headers.<span class="fn">get</span>(<span class="str">"Retry-After"</span>, backoff))
            time.<span class="fn">sleep</span>(wait); <span class="kw">continue</span>

        <span class="kw">if</span> <span class="nb">500</span> &lt;= resp.status_code &lt; <span class="nb">600</span>:                   <span class="cm"># server error</span>
            time.<span class="fn">sleep</span>(backoff); backoff *= <span class="nb">2</span>; <span class="kw">continue</span>

        resp.<span class="fn">raise_for_status</span>()                              <span class="cm"># other errors</span>

    <span class="kw">raise</span> <span class="cl">Exception</span>(<span class="str">f"EXHAUSTED {max_retries} RETRIES: GET {url}"</span>)</pre>
      </div>
    </div>

    <div class="code-panel" id="code-merge">
      <div class="code-window reveal">
        <div class="code-window-bar">
          <div class="tbar-dot" style="background:#ef4444;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#f59e0b;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#10b981;width:10px;height:10px;border-radius:50%"></div>
          <span>bronze_parent.py ‚Äî Delta MERGE upsert</span>
        </div>
        <pre><span class="cm"># Build DataFrame from batch buffer</span>
df = spark.<span class="fn">createDataFrame</span>(batch_buffer) \
    .<span class="fn">withColumn</span>(<span class="str">"_ingested_at"</span>, <span class="fn">current_timestamp</span>()) \
    .<span class="fn">withColumn</span>(<span class="str">"_modified_at"</span>, <span class="fn">current_timestamp</span>()) \
    .<span class="fn">withColumn</span>(<span class="str">"_pipeline_run_id"</span>, <span class="fn">lit</span>(run_id))

df.<span class="fn">createOrReplaceTempView</span>(<span class="str">"__items_batch_tmp"</span>)

<span class="cm"># Columns to update (everything except PK and _ingested_at)</span>
update_cols   = [c <span class="kw">for</span> c <span class="kw">in</span> df.columns <span class="kw">if</span> c != <span class="str">"_ingested_at"</span> <span class="kw">and</span> c != ID_FIELD]
update_clause = <span class="str">", "</span>.<span class="fn">join</span>([<span class="str">f"tgt.{c} = src.{c}"</span> <span class="kw">for</span> c <span class="kw">in</span> update_cols])

<span class="cm"># MERGE: upsert ‚Äî preserves _ingested_at for existing rows (audit trail)</span>
spark.<span class="fn">sql</span>(<span class="str">f"""
    MERGE INTO {TARGET_TABLE} AS tgt
    USING __items_batch_tmp AS src
    ON tgt.{ID_FIELD} = src.{ID_FIELD}
    WHEN MATCHED THEN
        UPDATE SET {update_clause}         -- updates all except _ingested_at
    WHEN NOT MATCHED THEN
        INSERT *                           -- new records: insert everything
"""</span>)</pre>
      </div>
    </div>

    <div class="code-panel" id="code-parallel">
      <div class="code-window reveal">
        <div class="code-window-bar">
          <div class="tbar-dot" style="background:#ef4444;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#f59e0b;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#10b981;width:10px;height:10px;border-radius:50%"></div>
          <span>bronze_child.py ‚Äî ThreadPoolExecutor parallel fetch</span>
        </div>
        <pre><span class="cm"># PARALLELISM = 10 concurrent API workers (from config)</span>
<span class="kw">with</span> <span class="cl">ThreadPoolExecutor</span>(max_workers=PARALLELISM) <span class="kw">as</span> executor:

    <span class="cm"># Submit all item GUIDs as concurrent futures</span>
    futures = {
        executor.<span class="fn">submit</span>(fetch_child_data, guid): guid
        <span class="kw">for</span> guid <span class="kw">in</span> item_guids
    }

    <span class="kw">for</span> future <span class="kw">in</span> <span class="fn">as_completed</span>(futures):
        item_guid, response_json, error_type, error_msg = future.<span class="fn">result</span>()

        <span class="kw">if</span>   error_type == <span class="str">"SKIP"</span>: skipped_count += <span class="nb">1</span>   <span class="cm"># 403/404 ‚Äî move on</span>
        <span class="kw">elif</span> error_type == <span class="str">"FAIL"</span>: failed_guids.<span class="fn">append</span>(item_guid)
        <span class="kw">else</span>:
            batch_buffer.<span class="fn">append</span>({
                <span class="str">"item_guid"</span>:        item_guid,
                <span class="str">"response_json"</span>:    response_json,
                <span class="str">"_pipeline_run_id"</span>: run_id
            })

        <span class="cm"># Write batch every BATCH_SIZE records (500)</span>
        <span class="kw">if</span> <span class="fn">len</span>(batch_buffer) >= BATCH_SIZE:
            <span class="fn">merge_batch</span>(batch_buffer)
            batch_buffer = []</pre>
      </div>
    </div>

    <div class="code-panel" id="code-antijoin">
      <div class="code-window reveal">
        <div class="code-window-bar">
          <div class="tbar-dot" style="background:#ef4444;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#f59e0b;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#10b981;width:10px;height:10px;border-radius:50%"></div>
          <span>bronze_grandchild.py ‚Äî Spark anti-join deduplication</span>
        </div>
        <pre><span class="cm"># Create Spark DataFrame from candidate BOM lines</span>
bom_lines_df = spark.<span class="fn">createDataFrame</span>(bom_lines)

<span class="cm"># Load already-processed combinations from target table</span>
existing_df  = spark.<span class="fn">sql</span>(<span class="str">f"""
    SELECT DISTINCT item_guid, bom_line_guid
    FROM {TARGET_TABLE}
"""</span>)

<span class="cm"># LEFT ANTI JOIN: keep only records NOT in target table</span>
<span class="cm"># Runs distributed in Spark executors ‚Äî scales to millions</span>
new_records_df = bom_lines_df.<span class="fn">join</span>(
    existing_df,
    (bom_lines_df[<span class="str">"item_guid"</span>]     == existing_df[<span class="str">"item_guid"</span>]) &
    (bom_lines_df[<span class="str">"bom_line_guid"</span>] == existing_df[<span class="str">"bom_line_guid"</span>]),
    <span class="str">"left_anti"</span>   <span class="cm"># ‚Üê only rows with NO match in target</span>
)

new_count        = new_records_df.<span class="fn">count</span>()
skipped_existing = total_bom_lines - new_count

print(<span class="str">f"  ‚úî Skipping {skipped_existing} already-processed records"</span>)
bom_lines = [row.<span class="fn">asDict</span>() <span class="kw">for</span> row <span class="kw">in</span> new_records_df.<span class="fn">collect</span>()]</pre>
      </div>
    </div>

    <div class="code-panel" id="code-control">
      <div class="code-window reveal">
        <div class="code-window-bar">
          <div class="tbar-dot" style="background:#ef4444;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#f59e0b;width:10px;height:10px;border-radius:50%"></div>
          <div class="tbar-dot" style="background:#10b981;width:10px;height:10px;border-radius:50%"></div>
          <span>utility.py ‚Äî control table checkpointing</span>
        </div>
        <pre><span class="cm"># Control table schema ‚Äî full audit trail per run</span>
spark.<span class="fn">sql</span>(<span class="str">f"""
    CREATE TABLE IF NOT EXISTS {CONTROL_TABLE} (
        pipeline_name        STRING,    -- e.g. 'items', 'bom_pipeline'
        run_id               STRING,    -- UUID per run
        run_type             STRING,    -- HISTORICAL | INCREMENTAL
        last_offset          LONG,      -- resume point on crash
        records_processed    LONG,
        total_records_in_table LONG,
        start_time           TIMESTAMP,
        end_time             TIMESTAMP,
        status               STRING,    -- IN_PROGRESS | SUCCESS | FAILURE | PARTIAL_SUCCESS
        error_message        STRING,
        endpoint_url         STRING
    ) USING DELTA
"""</span>)

<span class="cm"># Auto-detect: check last SUCCESS to decide HISTORICAL vs INCREMENTAL</span>
result = spark.<span class="fn">sql</span>(<span class="str">f"""
    SELECT last_offset, total_records_in_table
    FROM   {CONTROL_TABLE}
    WHERE  pipeline_name = '{ENDPOINT_NAME}'
      AND  status        = 'SUCCESS'
    ORDER  BY end_time DESC
    LIMIT  1
"""</span>).<span class="fn">collect</span>()

LOAD_TYPE = <span class="str">"INCREMENTAL"</span> <span class="kw">if</span> result <span class="kw">else</span> <span class="str">"HISTORICAL"</span></pre>
      </div>
    </div>

  </div>
</section>

<!-- DATA MODEL -->
<section id="datamodel">
  <div class="section-inner">
    <div class="section-label reveal">Data Model</div>
    <h2 class="reveal">Bronze tables in Unity Catalog</h2>
    <p class="section-sub reveal">
      All tables land in <code style="font-family:var(--mono);font-size:13px;color:var(--accent2)">kymeta_dbx_workspace_test.arena_bronze</code> as Delta tables with consistent metadata columns.
    </p>

    <div class="tables-grid">
      <div class="table-card reveal">
        <div class="table-header">
          <div class="table-name">üì¶ items <span class="table-badge tb-bronze">bronze</span></div>
        </div>
        <div class="table-body">
          <div class="col-row"><span class="col-name">guid</span><span class="col-pk">PK</span></div>
          <div class="col-row"><span class="col-name">number</span><span class="col-type">string</span></div>
          <div class="col-row"><span class="col-name">name</span><span class="col-type">string</span></div>
          <div class="col-row"><span class="col-name">procurementType</span><span class="col-type">string</span></div>
          <div class="col-row"><span class="col-name col-meta">_ingested_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_modified_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_pipeline_run_id</span><span class="col-meta">lineage</span></div>
        </div>
      </div>

      <div class="table-card reveal">
        <div class="table-header">
          <div class="table-name">üîó item_bom <span class="table-badge tb-bronze">bronze</span></div>
        </div>
        <div class="table-body">
          <div class="col-row"><span class="col-name">item_guid</span><span class="col-pk">FK ‚Üí items</span></div>
          <div class="col-row"><span class="col-name">response_json</span><span class="col-type">string (raw)</span></div>
          <div class="col-row"><span class="col-name col-meta">_ingested_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_modified_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_pipeline_run_id</span><span class="col-meta">lineage</span></div>
        </div>
      </div>

      <div class="table-card reveal">
        <div class="table-header">
          <div class="table-name">üìã item_revisions <span class="table-badge tb-bronze">bronze</span></div>
        </div>
        <div class="table-body">
          <div class="col-row"><span class="col-name">item_guid</span><span class="col-pk">FK ‚Üí items</span></div>
          <div class="col-row"><span class="col-name">response_json</span><span class="col-type">string (raw)</span></div>
          <div class="col-row"><span class="col-name col-meta">_ingested_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_modified_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_pipeline_run_id</span><span class="col-meta">lineage</span></div>
        </div>
      </div>

      <div class="table-card reveal">
        <div class="table-header">
          <div class="table-name">üí∞ item_procurement <span class="table-badge tb-bronze">bronze</span></div>
        </div>
        <div class="table-body">
          <div class="col-row"><span class="col-name">item_guid</span><span class="col-pk">FK ‚Üí items</span></div>
          <div class="col-row"><span class="col-name">response_json</span><span class="col-type">string (raw)</span></div>
          <div class="col-row"><span class="col-name col-meta">_ingested_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_modified_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_pipeline_run_id</span><span class="col-meta">lineage</span></div>
        </div>
      </div>

      <div class="table-card reveal">
        <div class="table-header">
          <div class="table-name">üß© item_bom_substitutes <span class="table-badge tb-bronze">bronze</span></div>
        </div>
        <div class="table-body">
          <div class="col-row"><span class="col-name">item_guid</span><span class="col-pk">FK ‚Üí items</span></div>
          <div class="col-row"><span class="col-name">bom_line_guid</span><span class="col-pk">FK ‚Üí item_bom</span></div>
          <div class="col-row"><span class="col-name">response_json</span><span class="col-type">string (raw)</span></div>
          <div class="col-row"><span class="col-name col-meta">_ingested_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_modified_at</span><span class="col-meta">audit</span></div>
          <div class="col-row"><span class="col-name col-meta">_pipeline_run_id</span><span class="col-meta">lineage</span></div>
        </div>
      </div>

      <div class="table-card reveal">
        <div class="table-header">
          <div class="table-name">üìä arena_control <span class="table-badge tb-silver">control</span></div>
        </div>
        <div class="table-body">
          <div class="col-row"><span class="col-name">run_id</span><span class="col-pk">UUID</span></div>
          <div class="col-row"><span class="col-name">pipeline_name</span><span class="col-type">string</span></div>
          <div class="col-row"><span class="col-name">run_type</span><span class="col-type">HIST | INCR</span></div>
          <div class="col-row"><span class="col-name">last_offset</span><span class="col-type">long</span></div>
          <div class="col-row"><span class="col-name">status</span><span class="col-type">SUCCESS | FAIL‚Ä¶</span></div>
          <div class="col-row"><span class="col-name">records_processed</span><span class="col-type">long</span></div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- METRICS -->
<section id="impact" style="background:var(--bg2)">
  <div class="section-inner">
    <div class="section-label reveal">Impact</div>
    <h2 class="reveal">From zero to production</h2>

    <div class="metrics-row">
      <div class="metric-card reveal">
        <div class="metric-val"><span class="unit">5</span></div>
        <div class="metric-desc">Delta tables created across 3 hierarchy levels ‚Äî Items, BOM, Revisions, Procurement, Substitutes</div>
      </div>
      <div class="metric-card reveal">
        <div class="metric-val"><span class="unit">10√ó</span></div>
        <div class="metric-desc">Faster child endpoint fetching via parallel ThreadPoolExecutor vs sequential API calls</div>
      </div>
      <div class="metric-card reveal">
        <div class="metric-val"><span class="unit">0</span></div>
        <div class="metric-desc">Code changes needed to add a new Arena endpoint ‚Äî just a config.json entry</div>
      </div>
      <div class="metric-card reveal">
        <div class="metric-val"><span class="unit">‚àû</span></div>
        <div class="metric-desc">Reruns safe ‚Äî idempotent MERGE upserts mean no duplicate records regardless of how many times it runs</div>
      </div>
    </div>
  </div>
</section>

<!-- SKILLS -->
<section class="skills-section" id="skills">
  <div class="section-inner">
    <div class="section-label reveal">Skills Demonstrated</div>
    <h2 class="reveal">What this project shows</h2>

    <div class="skills-grid">
      <div class="skill-item reveal">
        <div class="skill-cat sc-python">Python</div>
        <div class="skill-text"><strong>OOP session management</strong> ‚Äî ArenaSession class with login, refresh, and header management. concurrent.futures ThreadPoolExecutor for I/O-bound parallelism. Exponential backoff retry loops.</div>
      </div>
      <div class="skill-item reveal">
        <div class="skill-cat sc-spark">PySpark</div>
        <div class="skill-text"><strong>DataFrame operations</strong> ‚Äî createDataFrame, withColumn, createOrReplaceTempView. LEFT ANTI JOIN for distributed deduplication. Schema inference with autoMerge.</div>
      </div>
      <div class="skill-item reveal">
        <div class="skill-cat sc-delta">Delta Lake</div>
        <div class="skill-text"><strong>MERGE INTO upserts</strong> ‚Äî idempotent writes with PK matching. Selective column updates (preserving _ingested_at). Table creation with schema evolution via mergeSchema.</div>
      </div>
      <div class="skill-item reveal">
        <div class="skill-cat sc-api">REST APIs</div>
        <div class="skill-text"><strong>Offset pagination</strong> ‚Äî incrementing by actual records received (not page size) to handle partial final pages. 401/429/5xx handling. Multi-level nested API hierarchy traversal.</div>
      </div>
      <div class="skill-item reveal">
        <div class="skill-cat sc-de">Data Eng</div>
        <div class="skill-text"><strong>Medallion architecture</strong> ‚Äî raw JSON landing in bronze with full audit metadata. Control table checkpointing for crash recovery. HISTORICAL vs INCREMENTAL auto-detection.</div>
      </div>
      <div class="skill-item reveal">
        <div class="skill-cat sc-de">Databricks</div>
        <div class="skill-text"><strong>Unity Catalog</strong> ‚Äî catalog/schema/table hierarchy. Databricks secret scope for credentials. dbutils.notebook for dynamic path resolution. Delta auto-merge config.</div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-left">
    <strong>Arena PLM Ingestion Pipeline</strong> ‚Äî built for production on Databricks Unity Catalog
  </div>
  <div class="footer-links">
    <a href="index.html">‚Üê Back to Portfolio</a>
    <a href="cts-portfolio.html">CTS Tool ‚Üí</a>
  </div>
</footer>

<script>
  function showCode(id) {
    document.querySelectorAll('.code-panel').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.code-tab').forEach(b => b.classList.remove('active'));
    document.getElementById('code-' + id).classList.add('active');
    event.target.classList.add('active');
  }

  const obs = new IntersectionObserver(entries => {
    entries.forEach((e, i) => {
      if (e.isIntersecting) setTimeout(() => e.target.classList.add('in'), i * 50);
    });
  }, { threshold: 0.08 });
  document.querySelectorAll('.reveal').forEach(el => obs.observe(el));
</script>
</body>
</html>
